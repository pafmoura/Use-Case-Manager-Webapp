<app-header></app-header>

<app-titlebanner title="Adicionar Use Case" image="./assets/bannercover.jpg"></app-titlebanner>




<form class="grid grid-cols-2 gap-12 px-32 pt-12"  [formGroup]="createUseCaseForm" (ngSubmit)="createUseCase()">
    <div class="space-y-4 col-span-2 md:col-span-1">

        <label for="title" class="block text-sm font-medium leading-6 text-gray-900">Título</label>
        <input id="title"  name="title" placeholder="Título do Use Case"  type="title" autocomplete="title" formControlName="title" required class="block w-full rounded-md border-0 px-2 py-2.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">

       
    </div>



    <div class="space-y-4 col-span-2 md:col-span-1">
        <label for="mitreTechniques"  class="block text-sm font-medium leading-6 text-gray-900">Técnicas Mitre Associadas
          <button data-popover-target="popover-description" data-popover-placement="bottom-end" type="button"><svg class="w-4 h-4 ms-2 text-gray-400 hover:text-gray-500" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg><span class="sr-only">Show information</span></button>
<div data-popover id="popover-description" role="tooltip" class="absolute z-10 invisible inline-block text-sm text-gray-500 transition-opacity duration-300 bg-white border border-gray-200 rounded-lg shadow-sm opacity-0 w-72 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400">
    <div class="p-3 space-y-2">
        <h3 class="font-semibold text-gray-900 dark:text-white">Classificação Utilizada pelo RedUCM</h3>
        <p>Utilizamos, para fácil identificação dos Use Cases, as técnicas MITRE definidas pela framework homónima.</p>
        <h3 class="font-semibold text-gray-900 dark:text-white">Como descubro a técnica MITRE em causa?</h3>
        <p>Através da consulta da framework, poderá/ão ser identificada(s) a(s) técnica(s) correspondente(s). Tal informação está disponível no endereço https://attack.mitre.org/techniques/ enterprise/ </p>
        <a href="https://attack.mitre.org/techniques/enterprise/" class="flex items-center font-medium text-blue-600 dark:text-blue-500 dark:hover:text-blue-600 hover:text-blue-700 hover:underline">Saber Mais <svg class="w-2 h-2 ms-1.5 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
  </svg></a>
    </div>
    <div data-popper-arrow></div>
</div>
        </label> 
      
        <tag-input theme='minimal' [secondaryPlaceholder]="'+ Nova Técnica'" [placeholder]="''"  formControlName="mitreTechniques"     class="block w-full rounded-md border-0 px-2  text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"></tag-input>

      
    </div>

    <div class="space-y-4 col-span-2 md:col-span-1">
        
        <label for="cncsClass"  class="block text-sm font-medium leading-6 text-gray-900">Classe CNCS
            <button data-popover-target="cncsdescription" data-popover-placement="bottom-end" type="button"><svg class="w-4 h-4 ms-2 text-gray-400 hover:text-gray-500" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg><span class="sr-only">Show information</span></button>
<div data-popover id="cncsdescription" role="tooltip" class="absolute z-10 invisible inline-block text-sm text-gray-500 transition-opacity duration-300 bg-white border border-gray-200 rounded-lg shadow-sm opacity-0 w-72 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400">
    <div class="p-3 space-y-2">
        <h3 class="font-semibold text-gray-900 dark:text-white">Classificação Utilizada pelo RedUCM</h3>
        <p>Para classificação do tipo de incidente, recorremos à taxonomia recomendada pelo Centro Nacional de Cibersegurança Português.</p>
        <h3 class="font-semibold text-gray-900 dark:text-white">Como identificar o Use Case nesta taxonomia?</h3>
        <p>Para identificar o Use Case no binómio Classe+Tipo, deverá ser consultada a documentação acessória, recomendada pelo CNCS em https://www.cncs.gov.pt/pt/certpt/taxonomia/ </p>
        <a href="https://www.cncs.gov.pt/pt/certpt/taxonomia/" class="flex items-center font-medium text-blue-600 dark:text-blue-500 dark:hover:text-blue-600 hover:text-blue-700 hover:underline">Saber Mais <svg class="w-2 h-2 ms-1.5 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
  </svg></a>
    </div>
    <div data-popper-arrow></div>
</div>
        </label>
       <!-- <input id="cncs" name="cncs"  type="cncs" [(ngModel)]="useCase.cncs" autocomplete="cncs" formControlName="cncs" required class="block w-full rounded-md border-0 px-2 py-2.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
   -->
   <select 
  id="cncsClass"
  name="cncsClass"
  [(ngModel)]="selectedCategory"
  [ngModelOptions]="{standalone: true}"
  (ngModelChange)="updateCNCSValues()"
  class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
  <option *ngFor="let option of chavesTaxonomia" [value]="option">{{ option }}</option>
</select>

       
   
        
   
    </div>

    
    
    <div class="space-y-4 col-span-2 md:col-span-1">
        <label for="cncsType" class="block text-sm font-medium leading-6 text-gray-900">Tipo CNCS</label>
        <!-- <input id="cncs" name="cncs"  type="cncs" [(ngModel)]="useCase.cncs" autocomplete="cncs" formControlName="cncs" required class="block w-full rounded-md border-0 px-2 py-2.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
    -->
    <select 
    id="cncsType"
    name="cncsType"
    [(ngModel)]="selectedSubcategory"
    [ngModelOptions]="{standalone: true}"
    class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
    <option *ngFor="let subcategory of selectedCategoryValues" [value]="subcategory">{{ subcategory }}</option>
  </select>
 
    </div>

    <div class="space-y-4 col-span-2 md:col-span-1">
        <label for="mitreTechniques" class="block text-sm font-medium leading-6 text-gray-900">Vetores de Ataque</label>
        <tag-input theme='minimal' [secondaryPlaceholder]="'+ Novo Vetor'" [placeholder]="''"    formControlName="attackVectors"     class="block w-full rounded-md border-0 px-2  text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"></tag-input>

      
    </div>

    <div class="space-y-4 col-span-2 md:col-span-1">
        <label for="playbook" class="block text-sm font-medium leading-6 text-gray-900">Playbook</label>
        <input id="playbook"  name="playbook"   type="url" autocomplete="playbook" formControlName="playbook" placeholder="https://url/img.jpg" required class="block w-full rounded-md border-0 px-2 py-2.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">

      
    </div>



<div class="space-y-4 col-span-4 md:col-span-2">
    <label for="description" class="block text-sm font-medium leading-6 text-gray-900">Descrição</label>
    <textarea id="description" placeholder="Descrição do Use Case. Neste parágrafo poderão ser descritos propósito, objetivos, entre outros." name="description" type="description"  autocomplete="description" formControlName="description" required class="block w-full rounded-md border-0 px-2 py-2 h-32 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"></textarea>
</div>

<div class="space-y-4 col-span-4 md:col-span-2">
    <label for="mitigation" class="block text-sm font-medium leading-6 text-gray-900">Mitigação</label>
    <textarea id="mitigation" placeholder="Neste parágrafo, poderão ser descritas as estratégias de mitigação" name="mitigation" type="mitigation"  autocomplete="mitigation" formControlName="mitigation" required class="block w-full rounded-md border-0 px-2 py-2 h-32 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"></textarea>
</div>

    <div class="space-y-6 col-span-2">
        <button type="submit" class="w-full md:w-[25rem] py-2.5 px-5 text-white font-semibold bg-redshift-red rounded-md hover:bg-redshift-red-dark">Registar</button>
    </div>
</form>

